<!DOCTYPE html>
<html>
<!--
    본 소스코드는 GPT API를 활용해보는 간단한 예시코드입니다
   소스코드 상에서 'API-KEY' 부분에 API를 발급받아서 넣고 주석을 해제하면 GPT API에 요청할 수 있습니다
   API의 발급은 다음 웹페이지에서 가능합니다
   https://platform.openai.com/account/api-keys
   API에 요청에 따른 비용이 과금될 수 있는점과 API키가 노출되지 않도록 유의해주세요.
   프론트엔드 코드는 노출될 수 있으므로 API키를 프론트엔드 코드에 넣지 않도록 유의해주세요.
-->

<head>
    <meta charset="UTF-8">
    <title>주식 관련 질문 요청</title>
    <style>
        body {
            background-color: black;
            color: white;
        }
    </style>
</head>

<body>
    <div>
        <textarea id="question" rows="5" cols="50"></textarea>
    </div>
    <div>
        <button onclick="submitQuestion()">질문 요청</button>
    </div>
    <div id="result"></div>
    <script>
        const chatGPT = async (messages, parameters = {}) => {
            //const apikey = 'API_KEY';
            if (messages[0].constructor === String) return await chatGPT([['user', messages[0]]]);
            messages = messages.map(line => ({ role: line[0], content: line[1].trim() }))
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${apikey}` },
                body: JSON.stringify({ model: 'gpt-3.5-turbo', prompt: messages[messages.length - 1].content, ...parameters }),
            });
            const data = await response.json();
            return data.choices[0].text.trim();
        };
        /*
        GPT test learning
                호랑이 - 어흥
                강아지 - 멍멍
                닭 - 꼬꼬댁
                고양이 - ?

        */
        async function submitQuestion() {
            var questionText = document.getElementById("question").value;
            questionText = `주식 초보자들에게 추천해줄 서적`
            const response = await chatGPT([
                ['user', '호랑이'],
                ['assistant', '어흥'],
                ['user', '강아지'],
                ['assistant', '멍멍'],
                ['user', '닭'],
                ['assistant', '꼬꼬댁'],
                ['user', '고양이'],
                
            ])
            var resultText = document.getElementById("result");
            resultText.innerText = response;
        }

    </script>
</body>

</html>
